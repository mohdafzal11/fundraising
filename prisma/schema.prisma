generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ProjectStatus {
  DRAFT
  PENDING
  APPROVED
  REJECTED
}

enum InvestorStatus {
  DRAFT
  PENDING
  APPROVED
  REJECTED
}

enum Currency {
  USD
  EUR
  BTC
  ETH
}

model Project {
  id              String        @id @default(cuid())
  slug            String        @unique
  name            String        
  symbol          String?
  title           String?
  description     String?
  category        String[]
  logo            String?
  logoAltText     String?
  links           Json?
  metaTitle       String?
  metaDescription String?
  metaKeywords    String?
  metaImage       String?
  status          ProjectStatus @default(DRAFT)

  rounds Round[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("projects")
}

model Round {
  id          String    @id @default(cuid())
  title       String?
  description String?
  date        DateTime?
  amount      String?
  type        String?

  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  investments Investment[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([projectId])
  @@map("rounds")
}

model Investor {
  id              String         @id @default(cuid())
  name            String
  slug            String         @unique
  logo            String?
  logoAltText     String?
  description     String?
  links           Json?
  type            String?
  investments     Investment[]
  status          InvestorStatus @default(DRAFT)
  metaTitle       String?
  metaDescription String?
  metaKeywords    String?
  metaImage       String?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt

  @@map("investors")
}

model Investment {
  id         String @id @default(cuid())
  roundId    String
  investorId String

  round    Round    @relation(fields: [roundId], references: [id], onDelete: Cascade)
  investor Investor @relation(fields: [investorId], references: [id], onDelete: Cascade)

  amount     String?
  currency   Currency? @default(USD)
  tokens     String?
  investedAt DateTime  @default(now())

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([roundId, investorId])
  @@index([roundId])
  @@index([investorId])
  @@map("investments")
}

model Page {
  id        String        @id @default(cuid())
  title     String?
  content   String?
  path      String        @unique
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt
  contents  PageContent[] @relation("PageToContent")
  faqs      PageFAQ[]     @relation("PageToFAQ")

  @@map("pages")
}

model PageFAQ {
  id        String   @id @default(cuid())
  question  String
  answer    String
  isActive  Boolean  @default(true)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  pageId    String
  page      Page     @relation("PageToFAQ", fields: [pageId], references: [id])

  @@index([pageId])
  @@index([isActive, order])
  @@map("page_faqs")
}

model PageContent {
  id        String   @id @default(cuid())
  title     String?
  content   String?
  order     Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  pageId    String
  page      Page     @relation("PageToContent", fields: [pageId], references: [id])

  @@index([pageId])
  @@index([isActive, order])
  @@map("page_contents")
}

model Section {
  id                      String   @id @default(cuid())
  title                   String?
  tableOfContent          String?
  description             String?
  isActive                Boolean  @default(true)
  isTableOfContentVisible Boolean  @default(true)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  tables                  Table[]  @relation("SectionToTable")

  @@map("sections")
}

model Table {
  id                      String   @id @default(cuid())
  title                   String
  tableOfContent          String?
  headers                 String[]
  rows                    Json[]
  isActive                Boolean  @default(true)
  isTableOfContentVisible Boolean  @default(true)
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  sectionId               String
  section                 Section  @relation("SectionToTable", fields: [sectionId], references: [id], onDelete: Cascade)

  @@index([sectionId])
  @@index([isActive])
  @@map("tables")
}